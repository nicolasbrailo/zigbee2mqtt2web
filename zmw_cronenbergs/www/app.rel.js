"use strict";class CronenbergMonitor extends React.Component{static buildProps(){return{key:"CronenbergMonitor"}}constructor(props){super(props);this.state={stats:null};this.fetchStats=this.fetchStats.bind(this)}async componentDidMount(){this.fetchStats()}on_app_became_visible(){this.fetchStats()}fetchStats(){mJsonGet("/stats",res=>{this.setState({stats:res})})}formatDate(dateString){const date=new Date(dateString);return date.toLocaleDateString()}formatTimestamp(isoString){const date=new Date(isoString);return date.toLocaleString()}calculateSummary(){if(!this.state.stats||this.state.stats.length===0){return{forgotten:0,clean:0}}const forgotten=this.state.stats.filter(s=>s.lights_forgotten).length;const clean=this.state.stats.filter(s=>!s.lights_forgotten).length;return{forgotten,clean}}render(){if(!this.state.stats){return React.createElement("div",{className:"app-loading"},"Loading...")}const summary=this.calculateSummary();return React.createElement("div",{id:"CronenbergMonitorContainer"},React.createElement("h3",null,React.createElement("img",{src:"/favicon.ico",alt:"Crons"}),"Light Check Statistics"),this.state.stats.length===0?React.createElement("p",null,"No light checks recorded yet"):React.createElement("div",null,React.createElement("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"5px"}},React.createElement("h4",{style:{marginTop:0}},"Summary"),React.createElement("div",{style:{display:"flex",gap:"30px",flexWrap:"wrap"}},React.createElement("div",null,React.createElement("span",{style:{color:"#ff6b6b",fontSize:"2em",fontWeight:"bold"}},summary.forgotten),React.createElement("div",{style:{color:"#888",fontSize:"0.9em"}},"Days with lights forgotten")),React.createElement("div",null,React.createElement("span",{style:{color:"#51cf66",fontSize:"2em",fontWeight:"bold"}},summary.clean),React.createElement("div",{style:{color:"#888",fontSize:"0.9em"}},"Days with no lights on")),React.createElement("div",null,React.createElement("span",{style:{color:"#4a90e2",fontSize:"2em",fontWeight:"bold"}},this.state.stats.length),React.createElement("div",{style:{color:"#888",fontSize:"0.9em"}},"Total checks (last 10 days)")))),React.createElement("h4",null,"Recent Checks"),React.createElement("ul",{style:{listStyle:"none",padding:0}},this.state.stats.slice().reverse().map((check,idx)=>this.renderCheck(check,idx)))))}renderCheck(check,idx){const statusColor=check.lights_forgotten?"#ff6b6b":"#51cf66";const statusIcon=check.lights_forgotten?"\u26A0\uFE0F":"\u2713";const statusText=check.lights_forgotten?"Lights forgotten":"All clear";return React.createElement("li",{key:idx,style:{marginBottom:"15px",padding:"12px",backgroundColor:"#2a2a2a",borderRadius:"5px",borderLeft:`4px solid ${statusColor}`}},React.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"}},React.createElement("div",null,React.createElement("span",{style:{fontSize:"1.2em"}},statusIcon),React.createElement("span",{style:{marginLeft:"10px",fontWeight:"bold",color:statusColor}},statusText)),React.createElement("div",{style:{color:"#888",fontSize:"0.9em"}},this.formatDate(check.date)," at ",new Date(check.timestamp).toLocaleTimeString())),check.lights_forgotten&&check.lights_left_on&&check.lights_left_on.length>0&&React.createElement("div",{style:{marginLeft:"30px",fontSize:"0.95em",color:"#ccc"}},React.createElement("strong",null,"Lights left on:")," ",check.lights_left_on.join(", ")))}}z2mStartReactApp("#app_root",CronenbergMonitor);
