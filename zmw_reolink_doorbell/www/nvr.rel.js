"use strict";function NVRViewer(props){const[cameras,setCameras]=React.useState([]);const[selectedCam,setSelectedCam]=React.useState(null);const[recordings,setRecordings]=React.useState([]);const[days,setDays]=React.useState(3);const[isLoading,setIsLoading]=React.useState(true);React.useEffect(()=>{mJsonGet("/nvr/api/cameras",cams=>{console.log(cams);setCameras(cams.cameras);if(cams.cameras.length>0){setSelectedCam(cams.cameras[0])}setIsLoading(false)})},[]);React.useEffect(()=>{if(!selectedCam)return;setIsLoading(true);mJsonGet(`/nvr/api/${selectedCam}/recordings?days=${days}`,data=>{setRecordings(data.recordings);setIsLoading(false)},err=>{setIsLoading(false)})},[selectedCam,days]);const formatFilename=filename=>{try{const dateStr=filename.split(".")[0];const hour=dateStr.split("_")[1];const month=parseInt(dateStr.substring(4,6));const day=parseInt(dateStr.substring(6,8));const hr=parseInt(hour.substring(0,2));const minute=parseInt(hour.substring(2,4));const monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];const monthName=monthNames[month-1]||`Month ${month}`;return`${monthName} - ${day.toString().padStart(2,"0")} - ${hr.toString().padStart(2,"0")}:${minute.toString().padStart(2,"0")}`}catch(e){return filename}};if(isLoading&&cameras.length===0){return React.createElement("div",{className:"nvr-container"},React.createElement("div",{className:"loading-message"},"Loading cameras..."))}return React.createElement("div",{className:"nvr-container"},React.createElement("h1",null,React.createElement("img",{src:"/favicon.ico",alt:"NVR"}),"NVR - Recordings"),React.createElement("div",{className:"nvr-controls"},cameras.length>1&&React.createElement("select",{value:selectedCam||"",onChange:e=>setSelectedCam(e.target.value)},cameras.map(cam=>React.createElement("option",{key:cam,value:cam},cam))),React.createElement("select",{value:days,onChange:e=>setDays(parseInt(e.target.value))},React.createElement("option",{value:"1"},"Last 1 day"),React.createElement("option",{value:"3"},"Last 3 days"),React.createElement("option",{value:"7"},"Last 7 days"),React.createElement("option",{value:"30"},"Last 30 days"),React.createElement("option",{value:"0"},"All recordings")),React.createElement("a",{href:"/",className:"back-link"},"\u2190 Back to Camera")),isLoading?React.createElement("div",{className:"loading-message"},"Loading recordings..."):recordings.length===0?React.createElement("div",{className:"empty-message"},"No recordings found for the selected period"):React.createElement("div",{className:"gallery-container"},recordings.map((rec,idx)=>React.createElement("div",{key:idx,className:"gallery-item"},React.createElement("a",{href:rec.video_url,target:"_blank"},React.createElement("img",{src:rec.thumbnail_url,alt:rec.filename}),React.createElement("div",{className:"gallery-item-info"},React.createElement("div",{className:"gallery-item-name"},formatFilename(rec.filename)),React.createElement("div",{className:"gallery-item-size"},rec.size)))))))}NVRViewer.buildProps=()=>({key:"nvr_viewer"});z2mStartReactApp("#app_root",NVRViewer);
